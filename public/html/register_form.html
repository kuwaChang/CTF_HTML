<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="../style.css">
    <title>新規登録フォーム</title>
    <style>
      .register-container {
        max-width: 450px;
        margin: 50px auto;
        background: rgba(250, 252, 255, 0.98);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(220, 220, 220, 0.3);
      }
      #registerForm h2 {
        color: #667eea;
        margin-bottom: 30px;
        font-size: 28px;
        text-align: center;
      }
      #registerForm {
        text-align: left;
      }
      #registerForm label {
        display: block;
        margin-bottom: 8px;
        color: #333;
        font-weight: 600;
        font-size: 14px;
      }
      #registerForm input {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid #e0e0e0;
        border-radius: 10px;
        font-size: 15px;
        transition: all 0.3s ease;
        background: #f8f9fa;
        margin-bottom: 15px;
      }
      #registerForm input:focus {
        outline: none;
        border-color: #667eea;
        background: white;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }
      #registerForm button {
        width: 100%;
        margin-top: 10px;
      }
      #registerMessage {
        margin-top: 15px;
        padding: 12px;
        border-radius: 8px;
        font-weight: 600;
        text-align: center;
        font-size: 14px;
      }
      #registerMessage:empty {
        display: none;
      }
      #registerMessage.success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }
      #registerMessage.error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
      .back-link {
        text-align: center;
        margin-top: 20px;
      }
      .back-link a {
        color: #667eea;
        text-decoration: none;
        font-weight: 600;
      }
      .back-link a:hover {
        text-decoration: underline;
      }
    </style>
  </head>

  <body>
    <div class="register-container">
      <form id="registerForm">
        <h2>✨ 新規登録</h2>
        <label>ユーザー名: <input type="text" name="username" required></label>
        <label>ユーザーID: <input type="text" name="userid" required></label>
        <label>パスワード: <input type="password" name="password" required></label>
        <button type="submit">登録</button>
      </form>   
      <p id="registerMessage"></p>
      <div class="back-link">
        <a href="index.html">← ログインページに戻る</a>
      </div>
    </div>
  </body>

  <script>
    // 新規登録処理
    document.getElementById("registerForm").addEventListener("submit", async (e) => {
        e.preventDefault();
        const data = {
        username: e.target.username.value,
        userid: e.target.userid.value,
        password: e.target.password.value
        };

        const res = await fetch("/auth/register", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
        });

        const result = await res.json();
        const messageEl = document.getElementById("registerMessage");
        messageEl.innerText = result.message;
        
        if (result.success) {
          messageEl.className = "success";
          setTimeout(() => {
            window.location.href = "index.html";
          }, 1500);
        } else {
          messageEl.className = "error";
        }
    });
  </script>
</html>
